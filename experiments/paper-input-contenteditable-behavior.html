<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->
<link rel="import" href="../../polymer/polymer.html">

<script>
  Polymer.PaperInputContentEditableBehaviorImpl = {
    properties: {
      focused: {
        type: Boolean,
        value: false
      }
    },

    attached: function() {
      // TODO: why is this needed? :()
      this.focused = false;
      this.invalid = false;

      var self = this;

      if (this.value) {
        this.$.input.textContent = this.value;
        this._onInput();
      }

      this.$.input.addEventListener('input', function() {
        self._onInput();
      });

      this.$.input.addEventListener('focus', function() {
        self.focused = true;
      });

      this.$.input.addEventListener('blur', function() {
        self.focused = false;
      });

      this.$.input.onpaste = function(e) {
        var pastedText = undefined;
        if (window.clipboardData && window.clipboardData.getData) { // IE
          pastedText = window.clipboardData.getData('Text');
        } else if (e.clipboardData && e.clipboardData.getData) {
          pastedText = e.clipboardData.getData('text/plain');
        }
        self.$.input.textContent = pastedText;
        self._onInput();
        return false; // Prevent the default handler from running.
      };
    },

    _onInput: function() {
      value = this.$.input.textContent;
      if (value || value === 0 || (!!this.placeholder && !this.value)) {
        this._hasContent = true;
      } else {
        this._hasContent = false;
      }
    }
  };

  Polymer.PaperInputContentEditableBehavior = [Polymer.PaperInputContentEditableBehaviorImpl];
</script>
